<!DOCTYPE html>
<html>
<head>
  <title>Gruntfile.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="doc-style.css" />
  <script src="doc-filelist.js"></script>
  <script>
    var relativeDir = "", thisFile = "Gruntfile.js", defaultSidebar = true;
  </script>
  <script src="doc-script.js"></script>
  <script src="fileSearch.js"></script>
  <link rel="stylesheet" href="fileSearch.css" />
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#task%20automation%20for%20icollege">Task automation for iCollege</a>
      </div>
      <div class="heading h2">
        <a href="#build%20file%20patterns">Build File Patterns</a>
      </div>
      <div class="heading h2">
        <a href="#grunt%20configuration">Grunt configuration</a>
      </div>
      <div class="heading h4">
        <a href="#load%20all%20grunt%20tasks">Load all grunt tasks</a>
      </div>
      <div class="heading h4">
        <a href="#common%20paths%20used%20by%20tasks">Common paths used by tasks</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-watch">grunt-contrib-watch</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-express-server">grunt-express-server</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-jshint">grunt-contrib-jshint</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-mocha-cli">grunt-mocha-cli</a>
      </div>
      <div class="heading h4">
        <a href="#all%20unit%20tests">All Unit tests</a>
      </div>
      <div class="heading h5">
        <a href="#groups%20of%20unit%20tests">Groups of unit tests</a>
      </div>
      <div class="heading h4">
        <a href="#all%20integration%20tests">All Integration tests</a>
      </div>
      <div class="heading h5">
        <a href="#model%20integration%20tests">Model integration tests</a>
      </div>
      <div class="heading h5">
        <a href="#api%20integration%20tests">API integration tests</a>
      </div>
      <div class="heading h4">
        <a href="#all%20route%20tests">All Route tests</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-shell">grunt-shell</a>
      </div>
      <div class="heading h4">
        <a href="#run%20sencha%20touch%20build">Run Sencha Touch Build</a>
      </div>
      <div class="heading h4">
        <a href="#run%20bower%20install">Run bower install</a>
      </div>
      <div class="heading h4">
        <a href="#generate%20coverage%20report">Generate coverage report</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-docker">grunt-docker</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-clean">grunt-contrib-clean</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-copy">grunt-contrib-copy</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-compress">grunt-contrib-compress</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-concat">grunt-contrib-concat</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-contrib-uglify">grunt-contrib-uglify</a>
      </div>
      <div class="heading h3">
        <a href="#grunt-update-submodules">grunt-update-submodules</a>
      </div>
      <div class="heading h2">
        <a href="#utilities">Utilities</a>
      </div>
      <div class="heading h3">
        <a href="#spawn%20casper.js">Spawn Casper.js</a>
      </div>
      <div class="heading h1">
        <a href="#custom%20tasks">Custom Tasks</a>
      </div>
      <div class="heading h3">
        <a href="#help">Help</a>
      </div>
      <div class="heading h3">
        <a href="#documentation">Documentation</a>
      </div>
      <div class="heading h2">
        <a href="#testing">Testing</a>
      </div>
      <div class="heading h4">
        <a href="#set%20test%20env%20(utility%20task)">Set Test Env (Utility Task)</a>
      </div>
      <div class="heading h4">
        <a href="#load%20config%20(utility%20task)">Load Config (Utility Task)</a>
      </div>
      <div class="heading h3">
        <a href="#validate">Validate</a>
      </div>
      <div class="heading h3">
        <a href="#unit%20tests%20(sub%20task)">Unit Tests (sub task)</a>
      </div>
      <div class="heading h3">
        <a href="#integration%20tests%20(sub%20task)">Integration tests (sub task)</a>
      </div>
      <div class="heading h3">
        <a href="#route%20tests%20(sub%20task)">Route tests (sub task)</a>
      </div>
      <div class="heading h3">
        <a href="#functional%20tests%20(sub%20task)">Functional tests (sub task)</a>
      </div>
      <div class="heading h3">
        <a href="#coverage">Coverage</a>
      </div>
      <div class="heading h2">
        <a href="#building%20assets">Building assets</a>
      </div>
      <div class="heading h3">
        <a href="#init%20assets">Init assets</a>
      </div>
      <div class="heading h3">
        <a href="#default%20asset%20build">Default asset build</a>
      </div>
      <div class="heading h3">
        <a href="#live%20reload">Live reload</a>
      </div>
      <div class="heading h3">
        <a href="#release">Release</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
<div class="pilwrap" id="task%20automation%20for%20icollege">
  <h1>
    <a href="#task%20automation%20for%20icollege" name="task%20automation%20for%20icollege" class="pilcrow">&#182;</a>
    Task automation for iCollege
  </h1>
</div>


<p>Run various tasks when developing for and working with iCollege.</p>

<p><strong>Usage instructions:</strong> can be found in the <a href="#custom%20tasks">Custom Tasks</a> section or by running <code>grunt --help</code>.</p>

<p><strong>Debug tip:</strong> If you have any problems with any Grunt tasks, try running them with the <code>--verbose</code> command</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">path</span>           <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">),</span>
    <span class="nx">colors</span>         <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;colors&#39;</span><span class="p">),</span>

    <span class="nx">fs</span>             <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">),</span>
    <span class="nx">_</span>              <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;lodash&#39;</span><span class="p">),</span>
    <span class="nx">buildDirectory</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">(),</span> <span class="s1">&#39;.build&#39;</span><span class="p">),</span>
    <span class="nx">distDirectory</span>  <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">cwd</span><span class="p">(),</span> <span class="s1">&#39;.dist&#39;</span><span class="p">),</span>

    <span class="nx">bootstrap</span>      <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./core/bootstrap&#39;</span><span class="p">),</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="build%20file%20patterns">
  <h2>
    <a href="#build%20file%20patterns" name="build%20file%20patterns" class="pilcrow">&#182;</a>
    Build File Patterns
  </h2>
</div>


<p>A list of files and patterns to include when creating a release zip.
This is read from the <code>.npmignore</code> file and all patterns are inverted as the <code>.npmignore</code>
file defines what to ignore, whereas we want to define what to include.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">buildGlob</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">splitter</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">platform</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^win/</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;\r\n&#39;</span> <span class="o">:</span> <span class="s1">&#39;\n&#39;</span><span class="p">;</span>
        <span class="cm">/*jslint stupid:true */</span>
        <span class="k">return</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;.npmignore&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">encoding</span><span class="o">:</span> <span class="s1">&#39;utf8&#39;</span><span class="p">}).</span><span class="nx">split</span><span class="p">(</span><span class="nx">splitter</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">pattern</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">pattern</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;!&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">pattern</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="nx">pattern</span><span class="p">;</span>
        <span class="p">});</span>

    <span class="p">}()),</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt%20configuration">
  <h2>
    <a href="#grunt%20configuration" name="grunt%20configuration" class="pilcrow">&#182;</a>
    Grunt configuration
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
    
    <span class="nx">configureGrunt</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p><em>This is not useful but required for jshint</em></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">colors</span><span class="p">.</span><span class="nx">setTheme</span><span class="p">({</span><span class="nx">silly</span><span class="o">:</span> <span class="s1">&#39;rainbow&#39;</span><span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="load%20all%20grunt%20tasks">
  <h4>
    <a href="#load%20all%20grunt%20tasks" name="load%20all%20grunt%20tasks" class="pilcrow">&#182;</a>
    Load all grunt tasks
  </h4>
</div>


<p>加载任务，通过匹配加载
Find all of the task which start with <code>grunt-</code> and load them, rather than explicitly declaring them all</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;matchdep&#39;</span><span class="p">).</span><span class="nx">filterDev</span><span class="p">([</span><span class="s1">&#39;grunt-*&#39;</span><span class="p">,</span> <span class="s1">&#39;!grunt-cli&#39;</span><span class="p">]).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">);</span>


        <span class="kd">var</span> <span class="nx">cfg</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="common%20paths%20used%20by%20tasks">
  <h4>
    <a href="#common%20paths%20used%20by%20tasks" name="common%20paths%20used%20by%20tasks" class="pilcrow">&#182;</a>
    Common paths used by tasks
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">build</span><span class="o">:</span> <span class="nx">buildDirectory</span><span class="p">,</span>
                <span class="nx">releaseBuild</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">buildDirectory</span><span class="p">,</span> <span class="s1">&#39;release&#39;</span><span class="p">),</span>
                <span class="nx">dist</span><span class="o">:</span> <span class="nx">distDirectory</span><span class="p">,</span>
                <span class="nx">releaseDist</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">distDirectory</span><span class="p">,</span> <span class="s1">&#39;release&#39;</span><span class="p">)</span>
            <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>Standard build type, for when we have nightlies again.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">buildType</span><span class="o">:</span> <span class="s1">&#39;Build&#39;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>Load package.json so that we can create correctly versioned releases.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">pkg</span><span class="o">:</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">readJSON</span><span class="p">(</span><span class="s1">&#39;package.json&#39;</span><span class="p">),</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-watch">
  <h3>
    <a href="#grunt-contrib-watch" name="grunt-contrib-watch" class="pilcrow">&#182;</a>
    grunt-contrib-watch
  </h3>
</div>


<p>See the <a href="#live%20reload">grunt dev</a> task for how this is used.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">watch</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">livereload</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
                        <span class="s1">&#39;core/client/*.js&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;core/client/app/**/*.js&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;core/built/scripts/*.js&#39;</span>
                    <span class="p">],</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">livereload</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nx">express</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">files</span><span class="o">:</span>  <span class="p">[</span><span class="s1">&#39;core/server.js&#39;</span><span class="p">,</span> <span class="s1">&#39;core/server/**/*.js&#39;</span><span class="p">],</span>
                    <span class="nx">tasks</span><span class="o">:</span>  <span class="p">[</span><span class="s1">&#39;express:dev&#39;</span><span class="p">],</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p><strong>Note:</strong> Without this option specified express won't be reloaded</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                        <span class="nx">nospawn</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-express-server">
  <h3>
    <a href="#grunt-express-server" name="grunt-express-server" class="pilcrow">&#182;</a>
    grunt-express-server
  </h3>
</div>


<p>Start a iCollege expess server for use in development and testing</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">express</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">script</span><span class="o">:</span> <span class="s1">&#39;index.js&#39;</span><span class="p">,</span>
                    <span class="nx">output</span><span class="o">:</span> <span class="s1">&#39;iCollege is running&#39;</span>
                <span class="p">},</span>

                <span class="nx">dev</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">node_env</span><span class="o">:</span> <span class="s1">&#39;development&#39;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">node_env</span><span class="o">:</span> <span class="s1">&#39;testing&#39;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-jshint">
  <h3>
    <a href="#grunt-contrib-jshint" name="grunt-contrib-jshint" class="pilcrow">&#182;</a>
    grunt-contrib-jshint
  </h3>
</div>


<p>Linting rules, run as part of <code>grunt validate</code>. See <a href="#validate">grunt validate</a> and its subtasks for
more information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">jshint</span><span class="o">:</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>Linting rules for server side or shared javascript code</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">jshintrc</span><span class="o">:</span> <span class="s1">&#39;.jshintrc&#39;</span>
                    <span class="p">},</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s1">&#39;*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;core/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;core/server/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;core/shared/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/shared/vendor/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/shared/lib/**/*.js&#39;</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>Linting rules for client side javascript code</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">client</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">jshintrc</span><span class="o">:</span> <span class="s1">&#39;core/client/.jshintrc&#39;</span>
                    <span class="p">},</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s1">&#39;core/client/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;core/client/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/client/.sencha/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/client/build/**/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/client/touch/*.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;!core/client/touch/**/*.js&#39;</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-mocha-cli">
  <h3>
    <a href="#grunt-mocha-cli" name="grunt-mocha-cli" class="pilcrow">&#182;</a>
    grunt-mocha-cli
  </h3>
</div>


<p>Configuration for the mocha test runner, used to run unit, integration and route tests as part of
<code>grunt validate</code>. See <a href="#validate">grunt validate</a> and its sub tasks for more information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">mochacli</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">ui</span><span class="o">:</span> <span class="s1">&#39;bdd&#39;</span><span class="p">,</span>
                    <span class="nx">reporter</span><span class="o">:</span> <span class="s1">&#39;spec&#39;</span><span class="p">,</span>
                    <span class="nx">timeout</span><span class="o">:</span> <span class="s1">&#39;15000&#39;</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="all%20unit%20tests">
  <h4>
    <a href="#all%20unit%20tests" name="all%20unit%20tests" class="pilcrow">&#182;</a>
    All Unit tests
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">unit</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/unit/**/*_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="groups%20of%20unit%20tests">
  <h5>
    <a href="#groups%20of%20unit%20tests" name="groups%20of%20unit%20tests" class="pilcrow">&#182;</a>
    Groups of unit tests
  </h5>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/unit/**/server*_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>

                <span class="nx">perm</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/unit/**/permissions_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>

                <span class="nx">migrate</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span>
                        <span class="s1">&#39;core/test/unit/**/export_spec.js&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;core/test/unit/**/import_spec.js&#39;</span>
                    <span class="p">]</span>
                <span class="p">},</span>

                <span class="nx">storage</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/unit/**/storage*_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="all%20integration%20tests">
  <h4>
    <a href="#all%20integration%20tests" name="all%20integration%20tests" class="pilcrow">&#182;</a>
    All Integration tests
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">integration</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span>
                        <span class="s1">&#39;core/test/integration/**/model*_spec.js&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;core/test/integration/**/api*_spec.js&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;core/test/integration/*_spec.js&#39;</span>
                    <span class="p">]</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="model%20integration%20tests">
  <h5>
    <a href="#model%20integration%20tests" name="model%20integration%20tests" class="pilcrow">&#182;</a>
    Model integration tests
  </h5>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">model</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/integration/**/model*_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="api%20integration%20tests">
  <h5>
    <a href="#api%20integration%20tests" name="api%20integration%20tests" class="pilcrow">&#182;</a>
    API integration tests
  </h5>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">api</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/integration/**/api*_spec.js&#39;</span><span class="p">]</span>
                <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="all%20route%20tests">
  <h4>
    <a href="#all%20route%20tests" name="all%20route%20tests" class="pilcrow">&#182;</a>
    All Route tests
  </h4>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">routes</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/test/functional/routes/**/*_test.js&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">},</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-shell">
  <h3>
    <a href="#grunt-shell" name="grunt-shell" class="pilcrow">&#182;</a>
    grunt-shell
  </h3>
</div>


<p>Command line tools where it's easier to run a command directly than configure a grunt plugin</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">shell</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">prepare_touch</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">command</span><span class="o">:</span> <span class="s2">&quot;git clone http://git.candylee.cn/doomdagger/touch.git ./core/client/touch&quot;</span><span class="p">,</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">stdout</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="run%20sencha%20touch%20build">
  <h4>
    <a href="#run%20sencha%20touch%20build" name="run%20sencha%20touch%20build" class="pilcrow">&#182;</a>
    Run Sencha Touch Build
  </h4>
</div>


<p>See the <code>grunt init</code>. See the section on <a href="#building%20assets">Building Assets</a> for more</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">touch</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">command</span><span class="o">:</span> <span class="p">[</span>
                        <span class="s1">&#39;cd ./core/client/&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;sencha app build&#39;</span>
                    <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">),</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">stdout</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="run%20bower%20install">
  <h4>
    <a href="#run%20bower%20install" name="run%20bower%20install" class="pilcrow">&#182;</a>
    Run bower install
  </h4>
</div>


<p>Used as part of <code>grunt init</code>. See the section on <a href="#building%20assets">Building Assets</a> for more
information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">bower</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">command</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;\\ &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/node_modules/.bin/bower install&#39;</span><span class="p">),</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">stdout</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="generate%20coverage%20report">
  <h4>
    <a href="#generate%20coverage%20report" name="generate%20coverage%20report" class="pilcrow">&#182;</a>
    Generate coverage report
  </h4>
</div>


<p>See the <code>grunt test-coverage</code> task in the section on <a href="#testing">Testing</a> for more information.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">coverage</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">command</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p><strong>Note:</strong> will only work on windows if mocha is globally installed</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                        <span class="kd">var</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">process</span><span class="p">.</span><span class="nx">platform</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^win/</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;mocha&#39;</span> <span class="o">:</span> <span class="s1">&#39;./node_modules/mocha/bin/mocha&#39;</span><span class="p">;</span>
                        <span class="k">return</span> <span class="nx">cmd</span> <span class="o">+</span>
                            <span class="s1">&#39; --timeout 15000 --reporter html-cov &gt; coverage.html ./core/test/blanket_coverage.js&#39;</span><span class="p">;</span>
                    <span class="p">},</span>
                    <span class="nx">execOptions</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">env</span><span class="o">:</span> <span class="s1">&#39;NODE_ENV=&#39;</span> <span class="o">+</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-docker">
  <h3>
    <a href="#grunt-docker" name="grunt-docker" class="pilcrow">&#182;</a>
    grunt-docker
  </h3>
</div>


<p>Generate documentation from code</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">docker</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">docs</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;docs&#39;</span><span class="p">,</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">],</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">onlyUpdated</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                        <span class="nx">exclude</span><span class="o">:</span> <span class="s1">&#39;node_modules,.git,.tmp,bower_components,content,*built,*test,*doc*,*vendor,&#39;</span> <span class="o">+</span>
                            <span class="s1">&#39;config.js,coverage.html,.travis.yml,*.min.css,screen.css,*touch*,*resources*,*.sencha*&#39;</span><span class="p">,</span>
                        <span class="nx">extras</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;fileSearch&#39;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-clean">
  <h3>
    <a href="#grunt-contrib-clean" name="grunt-contrib-clean" class="pilcrow">&#182;</a>
    grunt-contrib-clean
  </h3>
</div>


<p>Clean up files as part of other tasks</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">clean</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">built</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;core/built/**&#39;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="nx">release</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= paths.releaseBuild %&gt;/**&#39;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;content/data/iCollege-test.db&#39;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="nx">tmp</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;.tmp/**&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-copy">
  <h3>
    <a href="#grunt-contrib-copy" name="grunt-contrib-copy" class="pilcrow">&#182;</a>
    grunt-contrib-copy
  </h3>
</div>


<p>Copy files into their correct locations as part of building assets, or creating release zips</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">copy</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">release</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
                        <span class="nx">cwd</span><span class="o">:</span> <span class="s1">&#39;core/client/build/production/ICollege/&#39;</span><span class="p">,</span>
                        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;**&#39;</span><span class="p">],</span>
                        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;&lt;%= paths.releaseBuild %&gt;/core/client/&#39;</span><span class="p">,</span>
                        <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span>
                    <span class="p">},</span> <span class="p">{</span>
                        <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                        <span class="nx">src</span><span class="o">:</span> <span class="nx">buildGlob</span><span class="p">,</span>
                        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;&lt;%= paths.releaseBuild %&gt;/&#39;</span>
                    <span class="p">}]</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-compress">
  <h3>
    <a href="#grunt-contrib-compress" name="grunt-contrib-compress" class="pilcrow">&#182;</a>
    grunt-contrib-compress
  </h3>
</div>


<p>Zip up files for builds / releases</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">compress</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">release</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">archive</span><span class="o">:</span> <span class="s1">&#39;&lt;%= paths.releaseDist %&gt;/iCollege-&lt;%= pkg.version %&gt;.zip&#39;</span>
                    <span class="p">},</span>
                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">cwd</span><span class="o">:</span> <span class="s1">&#39;&lt;%= paths.releaseBuild %&gt;/&#39;</span><span class="p">,</span>
                    <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;**&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-concat">
  <h3>
    <a href="#grunt-contrib-concat" name="grunt-contrib-concat" class="pilcrow">&#182;</a>
    grunt-contrib-concat
  </h3>
</div>


<p>concatenate multiple JS files into a single file ready for use</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">concat</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">dev</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s1">&#39;core/built/scripts/vendor.js&#39;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s1">&#39;bower_components/jquery/dist/jquery.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;bower_components/lodash/dist/lodash.underscore.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;bower_components/moment/moment.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;bower_components/validator-js/validator.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;bower_components/Countable/Countable.js&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;bower_components/fastclick/lib/fastclick.js&#39;</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-contrib-uglify">
  <h3>
    <a href="#grunt-contrib-uglify" name="grunt-contrib-uglify" class="pilcrow">&#182;</a>
    grunt-contrib-uglify
  </h3>
</div>


<p>Minify concatenated javascript files ready for production</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">uglify</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">prod</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s1">&#39;core/built/scripts/vendor.min.js&#39;</span><span class="o">:</span> <span class="s1">&#39;core/built/scripts/vendor.js&#39;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="grunt-update-submodules">
  <h3>
    <a href="#grunt-update-submodules" name="grunt-update-submodules" class="pilcrow">&#182;</a>
    grunt-update-submodules
  </h3>
</div>


<p>Grunt task to update git submodules</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="s2">&quot;update_submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="k">default</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">params</span><span class="o">:</span> <span class="kc">false</span> <span class="c1">// blanks command-line parameters</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>


        <span class="p">};</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34">&#182;</a>
</div>
<p>Load the configuration
加载任务配置</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="utilities">
  <h2>
    <a href="#utilities" name="utilities" class="pilcrow">&#182;</a>
    Utilities
  </h2>
</div>



<div class="pilwrap" id="spawn%20casper.js">
  <h3>
    <a href="#spawn%20casper.js" name="spawn%20casper.js" class="pilcrow">&#182;</a>
    Spawn Casper.js
  </h3>
</div>


<p>Custom test runner for our Casper.js functional tests
This really ought to be refactored into a separate grunt task module</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;spawnCasperJS&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>

            <span class="nx">target</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">([</span><span class="s1">&#39;client&#39;</span><span class="p">],</span> <span class="nx">target</span><span class="p">)</span> <span class="o">?</span> <span class="nx">target</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">async</span><span class="p">(),</span>
                <span class="nx">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="s1">&#39;noPort&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">],</span>
                <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
                    <span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">grunt</span><span class="p">.</span><span class="nx">option</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">target</span> <span class="o">||</span> <span class="p">[</span><span class="s1">&#39;client/&#39;</span><span class="p">])</span>
                    <span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="s1">&#39;--includes=base.js&#39;</span><span class="p">,</span> <span class="s1">&#39;--log-level=debug&#39;</span><span class="p">,</span> <span class="s1">&#39;--port=1222&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>Forward parameters from grunt to casperjs</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">processOption</span><span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">grunt</span><span class="p">.</span><span class="nx">option</span><span class="p">(</span><span class="nx">option</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="nx">option</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">option</span><span class="p">(</span><span class="nx">option</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">grunt</span><span class="p">.</span><span class="nx">option</span><span class="p">(</span><span class="s1">&#39;fail-fast&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;--fail-fast&#39;</span><span class="p">);</span>
            <span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>Show concise logs in Travis as ours are getting too long</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">grunt</span><span class="p">.</span><span class="nx">option</span><span class="p">(</span><span class="s1">&#39;concise&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;--concise&#39;</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;--verbose&#39;</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">grunt</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
                <span class="nx">cmd</span><span class="o">:</span> <span class="s1">&#39;casperjs&#39;</span><span class="p">,</span>
                <span class="nx">args</span><span class="o">:</span> <span class="nx">args</span><span class="p">,</span>
                <span class="nx">opts</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">cwd</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;core/test/functional&#39;</span><span class="p">),</span>
                    <span class="nx">stdio</span><span class="o">:</span> <span class="s1">&#39;inherit&#39;</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">result</span><span class="cm">/*, code*/</span><span class="p">)</span> <span class="p">{</span>
                <span class="cm">/*jshint unused:false*/</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">grunt</span><span class="p">.</span><span class="nx">fail</span><span class="p">.</span><span class="nx">fatal</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">grunt</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">);</span>
                <span class="nx">done</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="custom%20tasks">
  <h1>
    <a href="#custom%20tasks" name="custom%20tasks" class="pilcrow">&#182;</a>
    Custom Tasks
  </h1>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<p>iCollege has a number of useful tasks that we use every day in development. Tasks marked as <em>Utility</em> are used
by grunt to perform current actions, but isn't useful to developers.</p>

<p>Skip ahead to the section on:</p>

<ul>
<li><a href="#building%20assets">Building assets</a>:
<code>grunt init</code>, <code>grunt</code> &amp; <code>grunt prod</code> or live reload with <code>grunt dev</code></li>
<li><a href="#testing">Testing</a>:
<code>grunt validate</code>, the <code>grunt test-*</code> sub-tasks or generate a coverage report with <code>grunt test-coverage</code>.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="help">
  <h3>
    <a href="#help" name="help" class="pilcrow">&#182;</a>
    Help
  </h3>
</div>


<p>Run <code>grunt help</code> on the commandline to get a print out of the available tasks and details of
what each one does along with any available options. This is an alias for <code>grunt --help</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;help&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Outputs help information if you type `grunt help` instead of `grunt --help`&#39;</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Type &#39;</span> <span class="o">+</span> <span class="s1">&#39;`grunt --help`&#39;</span><span class="p">.</span><span class="nx">yellow</span> <span class="o">+</span> <span class="s1">&#39; to get the details of available grunt tasks,\n&#39;</span> <span class="o">+</span>
                    <span class="s1">&#39;or alternatively visit &#39;</span> <span class="o">+</span> <span class="s1">&#39;https://github.com/TryGhost/iCollege/wiki/Grunt-Toolkit&#39;</span><span class="p">.</span><span class="nx">yellow</span><span class="p">);</span>
            <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="documentation">
  <h3>
    <a href="#documentation" name="documentation" class="pilcrow">&#182;</a>
    Documentation
  </h3>
</div>


<p>Run <code>grunt docs</code> to generate annotated source code using the documentation described in the code comments.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;docs&#39;</span><span class="p">,</span> <span class="s1">&#39;Generate Docs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;docker&#39;</span><span class="p">]);</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="testing">
  <h2>
    <a href="#testing" name="testing" class="pilcrow">&#182;</a>
    Testing
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<p>iCollege has an extensive set of test suites. The following section documents the various types of tests
and how to run them.</p>

<p>TLDR; run <code>grunt validate</code></p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="set%20test%20env%20(utility%20task)">
  <h4>
    <a href="#set%20test%20env%20(utility%20task)" name="set%20test%20env%20(utility%20task)" class="pilcrow">&#182;</a>
    Set Test Env <em>(Utility Task)</em>
  </h4>
</div>


<p>Set the NODE_ENV to 'testing' unless the environment is already set to TRAVIS.
This ensures that the tests get run under the correct environment, using the correct database, and
that they work as expected. Trying to run tests with no ENV set will throw an error to do with <code>client</code>.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Use &quot;testing&quot; iCollege config&#39;</span><span class="p">,</span>
            <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">=</span> <span class="s1">&#39;testing&#39;</span><span class="p">;</span>
                <span class="nx">cfg</span><span class="p">.</span><span class="nx">express</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">node_env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="p">;</span>
            <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="load%20config%20(utility%20task)">
  <h4>
    <a href="#load%20config%20(utility%20task)" name="load%20config%20(utility%20task)" class="pilcrow">&#182;</a>
    Load Config <em>(Utility Task)</em>
  </h4>
</div>


<p>Make sure that we have a <code>config.js</code> file when running tests
iCollege requires a <code>config.js</code> file to specify the database settings etc. iCollege comes with an example file:
<code>config.example.js</code> which is copied and renamed to <code>config.js</code> by the bootstrap process</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">async</span><span class="p">();</span>
            <span class="nx">bootstrap</span><span class="p">(</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<p>give me your config.js path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;config.js&#39;</span><span class="p">)</span>
            <span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">done</span><span class="p">();</span>
            <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">grunt</span><span class="p">.</span><span class="nx">fail</span><span class="p">.</span><span class="nx">fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">});</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="validate">
  <h3>
    <a href="#validate" name="validate" class="pilcrow">&#182;</a>
    Validate
  </h3>
</div>


<p><strong>Main testing task</strong></p>

<p><code>grunt validate</code> will lint and test your local iCollege codebase.</p>

<p><code>grunt validate</code> is one of the most important and useful grunt tasks that we have available to use. It
manages the setup and running of jshint as well as the 4 test suites. See the individual sub tasks below
for details of each of the test suites.</p>

<p><code>grunt validate</code> is called by <code>npm test</code>.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;validate&#39;</span><span class="p">,</span> <span class="s1">&#39;Run tests and lint code&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;jshint&#39;</span><span class="p">,</span> <span class="s1">&#39;test-routes&#39;</span><span class="p">,</span> <span class="s1">&#39;test-unit&#39;</span><span class="p">,</span> <span class="s1">&#39;test-integration&#39;</span><span class="p">,</span> <span class="s1">&#39;test-functional&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="unit%20tests%20(sub%20task)">
  <h3>
    <a href="#unit%20tests%20(sub%20task)" name="unit%20tests%20(sub%20task)" class="pilcrow">&#182;</a>
    Unit Tests <em>(sub task)</em>
  </h3>
</div>


<p><code>grunt test-unit</code> will run just the unit tests</p>

<p>Provided you already have a <code>config.js</code> file, you can run individual sections from
<a href="#grunt-mocha-cli">mochacli</a> by running:</p>

<p><code>NODE_ENV=testing grunt mochacli:section</code></p>

<p>If you need to run an individual unit test file, you can do so, providing you have mocha installed globally by
using a command in the form:</p>

<p><code>NODE_ENV=testing mocha --timeout=15000 --ui=bdd --reporter=spec core/test/unit/config_spec.js</code></p>

<p>Unit tests are run with <a href="http://visionmedia.github.io/mocha/">mocha</a> using
<a href="https://github.com/visionmedia/should.js">should</a> to describe the tests in a highly readable style.
Unit tests do <strong>not</strong> touch the database.
A coverage report can be generated for these tests using the <code>grunt test-coverage</code> task.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test-unit&#39;</span><span class="p">,</span> <span class="s1">&#39;Run unit tests (mocha)&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;clean:test&#39;</span><span class="p">,</span> <span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span> <span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;mochacli:unit&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="integration%20tests%20(sub%20task)">
  <h3>
    <a href="#integration%20tests%20(sub%20task)" name="integration%20tests%20(sub%20task)" class="pilcrow">&#182;</a>
    Integration tests <em>(sub task)</em>
  </h3>
</div>


<p><code>grunt test-integration</code> will run just the integration tests</p>

<p>Provided you already have a <code>config.js</code> file, you can run just the model integration tests by running:</p>

<p><code>NODE_ENV=testing grunt mochacli:model</code></p>

<p>Or just the api integration tests by running:</p>

<p><code>NODE_ENV=testing grunt mochacli:api</code></p>

<p>Integration tests are run with <a href="http://visionmedia.github.io/mocha/">mocha</a> using
<a href="https://github.com/visionmedia/should.js">should</a> to describe the tests in a highly readable style.
Integration tests are different to the unit tests because they make requests to the database.</p>

<p>Their purpose is to test that both the api and models behave as expected when the database layer is involved.
These tests are run against sqlite3, mysql and pg on travis and ensure that differences between the databases
don't cause bugs. At present, pg often fails and is not officially supported.</p>

<p>A coverage report can be generated for these tests using the <code>grunt test-coverage</code> task.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test-integration&#39;</span><span class="p">,</span> <span class="s1">&#39;Run integration tests (mocha + db access)&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;clean:test&#39;</span><span class="p">,</span> <span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span> <span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;mochacli:integration&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="route%20tests%20(sub%20task)">
  <h3>
    <a href="#route%20tests%20(sub%20task)" name="route%20tests%20(sub%20task)" class="pilcrow">&#182;</a>
    Route tests <em>(sub task)</em>
  </h3>
</div>


<p><code>grunt test-routes</code> will run just the route tests</p>

<p>If you need to run an individual route test file, you can do so, providing you have a <code>config.js</code> file and
mocha installed globally by using a command in the form:</p>

<p><code>NODE_ENV=testing mocha --timeout=15000 --ui=bdd --reporter=spec core/test/functional/routes/admin_test.js</code></p>

<p>Route tests are run with <a href="http://visionmedia.github.io/mocha/">mocha</a> using
<a href="https://github.com/visionmedia/should.js">should</a> and <a href="https://github.com/visionmedia/supertest">supertest</a>
to describe and create the tests.</p>

<p>Supertest enables us to describe requests that we want to make, and also describe the response we expect to
receive back. It works directly with express, so we don't have to run a server to run the tests.</p>

<p>The purpose of the route tests is to ensure that all of the routes (pages, and API requests) in iCollege
are working as expected, including checking the headers and status codes received. It is very easy and
quick to test many permutations of routes / urls in the system.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test-routes&#39;</span><span class="p">,</span> <span class="s1">&#39;Run functional route tests (mocha)&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;clean:test&#39;</span><span class="p">,</span> <span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span> <span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;mochacli:routes&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="functional%20tests%20(sub%20task)">
  <h3>
    <a href="#functional%20tests%20(sub%20task)" name="functional%20tests%20(sub%20task)" class="pilcrow">&#182;</a>
    Functional tests <em>(sub task)</em>
  </h3>
</div>


<p><code>grunt test-functional</code> will run just the functional tests</p>

<p>You can use the <code>--target</code> argument to run any individual test file, or the admin or frontend tests:</p>

<p><code>grunt test-functional --target=admin/editor_test.js</code> - run just the editor tests</p>

<p><code>grunt test-functional --target=admin/</code> - run all of the tests in the admin directory</p>

<p>Functional tests are run with <a href="http://phantomjs.org/">phantom.js</a> and defined using the testing api from
<a href="http://docs.casperjs.org/en/latest/testing.html">casper.js</a>.</p>

<p>An express server is started with the testing environment set, and then a headless phantom.js browser is
used to make requests to that server. The Casper.js API then allows us to describe the elements and
interactions we expect to appear on the page.</p>

<p>The purpose of the functional tests is to ensure that Ghost is working as is expected from a user perspective
including buttons and other important interactions in the admin UI.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test-functional&#39;</span><span class="p">,</span> <span class="s1">&#39;Run functional interface tests (CasperJS)&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;clean:test&#39;</span><span class="p">,</span> <span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span> <span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;express:test&#39;</span><span class="p">,</span> <span class="s1">&#39;spawnCasperJS&#39;</span><span class="p">,</span> <span class="s1">&#39;express:test:stop&#39;</span><span class="p">]</span>
        <span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="coverage">
  <h3>
    <a href="#coverage" name="coverage" class="pilcrow">&#182;</a>
    Coverage
  </h3>
</div>


<p><code>grunt test-coverage</code> will generate a report for the Unit and Integration Tests.</p>

<p>This is not currently done as part of CI or any build, but is a tool we have available to keep an eye on how
well the unit and integration tests are covering the code base.
iCollege does not have a minimum coverage level - we're more interested in ensuring important and useful areas
of the codebase are covered, than that the whole codebase is covered to a particular level.</p>

<p>Key areas for coverage are: helpers and theme elements, apps / GDK, the api and model layers.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;test-coverage&#39;</span><span class="p">,</span> <span class="s1">&#39;Generate unit and integration (mocha) tests coverage report&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;clean:test&#39;</span><span class="p">,</span> <span class="s1">&#39;setTestEnv&#39;</span><span class="p">,</span> <span class="s1">&#39;loadConfig&#39;</span><span class="p">,</span> <span class="s1">&#39;shell:coverage&#39;</span><span class="p">]);</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="building%20assets">
  <h2>
    <a href="#building%20assets" name="building%20assets" class="pilcrow">&#182;</a>
    Building assets
  </h2>
</div>


<p>Ghost's GitHub repository contains the un-built source code for Ghost. If you're looking for the already
built release zips, you can get these from the <a href="https://github.com/TryGhost/Ghost/releases">release page</a> on
GitHub or from <a href='https://ghost.org/download'>https://ghost.org/download</a>. These zip files are created using the <a href="#release">grunt release</a>
task.</p>

<p>If you want to work on Ghost core, or you want to use the source files from GitHub, then you have to build
the Ghost assets in order to make them work.</p>

<p>There are a number of grunt tasks available to help with this. Firstly after fetching an updated version of
the Ghost codebase, after running <code>npm install</code>, you will need to run <a href="#init%20assets">grunt init</a>.</p>

<p>For production blogs you will need to run <a href="#production%20assets">grunt prod</a>.</p>

<p>For updating assets during development, the tasks <a href="#default%20asset%20build">grunt</a> and
<a href="#live%20reload">grunt dev</a> are available.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="init%20assets">
  <h3>
    <a href="#init%20assets" name="init%20assets" class="pilcrow">&#182;</a>
    Init assets
  </h3>
</div>


<p><code>grunt init</code> - will run an initial asset build for you</p>

<p>Grunt init runs <code>bower install</code> as well as the standard asset build tasks which occur when you run just
<code>grunt</code>. This fetches the latest client side dependencies, and moves them into their proper homes.</p>

<p>This task is very important, and should always be run and when fetching down an updated code base just after
running <code>npm install</code>.</p>

<p><code>bower</code> does have some quirks, such as not running as root. If you have problems please try running
<code>grunt init --verbose</code> to see if there are any errors.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">,</span> <span class="s1">&#39;Prepare the project for development&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;shell:bower&#39;</span><span class="p">,</span> <span class="s1">&#39;update_submodules&#39;</span><span class="p">,</span> <span class="s1">&#39;shell:prepare_touch&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="default%20asset%20build">
  <h3>
    <a href="#default%20asset%20build" name="default%20asset%20build" class="pilcrow">&#182;</a>
    Default asset build
  </h3>
</div>


<p><code>grunt</code> - default grunt task</p>

<p>Compiles handlebars templates, concatenates javascript files for the admin UI into a handful of files instead
of many files, and makes sure the bower dependencies are in the right place.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;Build JS &amp; templates for development&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">]);</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="live%20reload">
  <h3>
    <a href="#live%20reload" name="live%20reload" class="pilcrow">&#182;</a>
    Live reload
  </h3>
</div>


<p><code>grunt dev</code> - build assets on the fly whilst developing</p>

<p>If you want iCollege to live reload for you whilst you're developing, you can do this by running <code>grunt dev</code>.
This works hand-in-hand with the <a href="http://livereload.com/">livereload</a> chrome extension.</p>

<p><code>grunt dev</code> manages starting an express server and restarting the server whenever core files change (which
require a server restart for the changes to take effect) and also manage reloading the browser whenever
frontend code changes.</p>

<p>Note that the current implementation of watch only works with casper, not other themes.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;dev&#39;</span><span class="p">,</span> <span class="s1">&#39;Dev Mode; watch files and restart server on changes&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;express:dev&#39;</span><span class="p">,</span> <span class="s1">&#39;watch&#39;</span><span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="release">
  <h3>
    <a href="#release" name="release" class="pilcrow">&#182;</a>
    Release
  </h3>
</div>


<p>Run <code>grunt release</code> to create a Ghost release zip file.
Uses the files specified by <code>.npmignore</code> to know what should and should not be included.
Runs the asset generation tasks for both development and production so that the release can be used in
either environment, and packages all the files up into a zip.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;release&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Release task - creates a final built zip\n&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; - Do our standard build steps (handlebars, etc)\n&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; - Copy files to release-folder/#/#{version} directory\n&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; - Clean out unnecessary files (travis, .git*, etc)\n&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; - Zip files in release-folder to dist-folder/#{version} directory&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;shell:bower&#39;</span><span class="p">,</span> <span class="s1">&#39;update_submodules&#39;</span><span class="p">,</span> <span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;uglify&#39;</span><span class="p">,</span> <span class="s1">&#39;shell:touch&#39;</span><span class="p">,</span> <span class="s1">&#39;clean:release&#39;</span><span class="p">,</span> <span class="s1">&#39;copy:release&#39;</span><span class="p">,</span> <span class="s1">&#39;compress:release&#39;</span><span class="p">]);</span>

    <span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<p>Export the configuration</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">configureGrunt</span><span class="p">;</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
